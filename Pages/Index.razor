<style>
  .greycliff {
        font-family: 'Greycliff CF', sans-serif;
    }

    .header-bar {
        background-color: #594AE2;
        padding: 1rem 2rem;
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top-left-radius: 0px;
        border-top-right-radius: 0px;
    }

    .logo {
        height: 30px;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .user-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
    }

.resumen-box {
    background-color: white;
    border-radius: 24px;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
    padding: 1.5rem;
    margin-top: 0.5rem;     
    margin-bottom: 1.25rem;
}


    .resumen-item {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .resumen-icono {
        width: 40px;
        height: 40px;
        background: #f2f2f2;
        border-radius: 50%;
        padding: 6px;
    }

    .resumen-texto {
        display: flex;
        flex-direction: column;
        font-size: 14px;
    }

    .resumen-monto {
        font-weight: 700;
        font-size: 1.2rem;
    }
</style>

<MudThemeProvider />
<MudDialogProvider />

<!-- ðŸ”¹ Header personalizado -->
<div class="header-bar greycliff">
    <img src="https://cadamenudo.github.io/UI-UX/assets/logo/cada-menudo-logo-white.png" alt="Logo" class="logo" />
    <div class="user-info">
        <span>Hola Xavier</span>
        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Avatar" class="user-avatar" />
    </div>
</div>

<!-- ðŸ”¹ Contenido general -->
<MudContainer MaxWidth="MaxWidth.Large" Class="pa-4 greycliff">

    <!-- ðŸ”¹ Resumen estilizado -->
    <MudPaper Class="resumen-box">
        <MudGrid>
            @foreach (var item in Resumen)
            {
                <MudItem Xs="4">
                    <div class="resumen-item">
                        <img src="@item.Icon" class="resumen-icono" />
                        <div class="resumen-texto">
                            <span>@item.Nombre</span>
                            <span class="resumen-monto">@item.Valor</span>
                        </div>
                    </div>
                </MudItem>
            }
        </MudGrid>
    </MudPaper>

    <!-- ðŸ”¹ SuperÃ¡vit -->
    <MudAlert Severity="Severity.Success" Dense="true" Class="my-2">
        âœ… SUPER: Tienes un sobrante de <strong>$@Superavit</strong>
    </MudAlert>

    <!-- ðŸ”¹ Fecha -->
    <MudGrid Class="my-3">
        <MudItem Xs="6">
            <MudDatePicker Label="Desde" Date="@FechaDesde" DateChanged="@(v => FechaDesde = v)" />
        </MudItem>
        <MudItem Xs="6">
            <MudDatePicker Label="Hasta" Date="@FechaHasta" DateChanged="@(v => FechaHasta = v)" />
        </MudItem>
    </MudGrid>

    <!-- ðŸ”¹ GrÃ¡ficos -->
    <MudPaper Class="pa-4 my-4" Style="border-radius:16px;">
        <MudText Typo="Typo.h6" Align="Align.Center">Ingresos Totales</MudText>
        <MudChart ChartType="ChartType.Pie" Labels="_labels" Data="_donutIngresos" />
    </MudPaper>

    <MudPaper Class="pa-4 my-4" Style="border-radius:16px;">
        <MudText Typo="Typo.h6" Align="Align.Center">Gastos Totales</MudText>
        <MudChart ChartType="ChartType.Pie" Labels="_labels" Data="_donutGastos" />
    </MudPaper>

    <MudPaper Class="pa-4 my-4" Style="border-radius:16px;">
        <MudText Typo="Typo.h6" Align="Align.Center">Meta para el aÃ±o</MudText>
        <MudChart ChartType="ChartType.Bar" Labels="_labels" Data="_barData" />
    </MudPaper>
</MudContainer>

<!-- ðŸ”¹ Footer -->
<footer class="navbar" style="margin-top: 2rem; padding: 1rem; display: flex; justify-content: space-around; background: #f5f5f5;">
    <div class="nav-item">
        <img src="https://cadamenudo.github.io/UI-UX/assets/icons/home.png" alt="Inicio" style="width: 32px;" />
        <div>Tablero</div>
    </div>
    <div class="nav-item">
        <img src="https://cadamenudo.github.io/UI-UX/assets/icons/transacciones.png" alt="Transacciones" style="width: 32px;" />
        <div>Transacciones</div>
    </div>
    <div class="nav-item">
        <img src="https://cadamenudo.github.io/UI-UX/assets/icons/nueva.png" alt="Nueva" style="width: 48px;" />
        <div>Registrar</div>
    </div>
    <div class="nav-item">
        <img src="https://cadamenudo.github.io/UI-UX/assets/icons/metas.png" alt="Metas" style="width: 32px;" />
        <div>Metas</div>
    </div>
    <div class="nav-item">
        <img src="https://cadamenudo.github.io/UI-UX/assets/icons/buscar.png" alt="Buscar" style="width: 32px;" />
        <div>Buscar</div>
    </div>
</footer>

<!-- ðŸ”¹ Legal -->
<div class="footer-legales greycliff" style="text-align: center; margin: 1rem 0;">
    <MudButton Variant="Variant.Text" OnClick='@(() => AbrirModal("TÃ©rminos", "https://cadamenudo.github.io/UI-UX/terminos.html"))'>TÃ©rminos</MudButton>
    <MudButton Variant="Variant.Text" OnClick='@(() => AbrirModal("Privacidad", "https://cadamenudo.github.io/UI-UX/privacidad.html"))'>Privacidad</MudButton>
    <a href="mailto:tech@cadamenudo.com" style="margin-left: 1rem;">tech@cadamenudo.com</a>
</div>

@code {
    private DateTime? FechaDesde = new DateTime(2025, 1, 1);
    private DateTime? FechaHasta = new DateTime(2025, 5, 31);
    private string Superavit = "1,868.77";

    private List<(string Nombre, string Valor, string Icon)> Resumen = new()
    {
        ("Ingresos", "$6,000.00", "https://cadamenudo.github.io/UI-UX/assets/icons/ingreso.png"),
        ("Gastos", "$3,531.23", "https://cadamenudo.github.io/UI-UX/assets/icons/gastos.png"),
        ("Ahorros", "$600.00", "https://cadamenudo.github.io/UI-UX/assets/icons/ahorro.png")
    };

    private string[] _labels = { "Enero", "Febrero", "Marzo" };
    private double[] _donutIngresos = { 2500, 2000, 1500 };
    private double[] _donutGastos = { 1200, 1400, 900 };
    private double[] _barData = { 4000, 4500, 3800 };

    [Inject] IDialogService DialogService { get; set; }

    private async Task AbrirModal(string titulo, string url)
    {
        await DialogService.ShowMessageBox(
            title: titulo,
            markupMessage: (MarkupString)$"<iframe src='{url}' width='100%' height='300px' frameborder='0'></iframe>",
            yesText: "Cerrar"
        );
    }
}
